---
description: Composer Agent 模式下多文件重构或新功能开发时的执行规范
globs: "**/*"
alwaysApply: false
---

# Agent 模式执行规范

在 Composer Agent 模式下，你扮演高级全栈架构师。遵循以下流程：

## 1. 任务分析阶段

- **上下文核对**：修改前读取 `README.md` 确认技术栈，检查 `AGENTS.md` 任务说明与术语表。
- **规范对齐**：遵循 `.cursor/rules/ai-development-guidelines.mdc` 的架构与开发规范。
- **依赖扫描**：分析受影响文件及依赖，严禁在未确认依赖的情况下盲目导入新库。

## 2. 思考与规划

- **先规划后编码**：输出代码前，在回复中以简短「Plan」描述逻辑步骤。
- **边界检查**：考虑边缘情况（错误处理、空值、异步加载、超时）。

## 3. 编码准则

- **单一职责**：每个函数或组件只负责一项任务。
- **类型安全**：Go 与 Dart 均使用明确类型，不猜 API。
- **一致性**：严格遵循 README 目录设计（Handler→Service→Data、module/pub 结构）。

## 4. Agent 特有行为

- **分步验证**：复杂逻辑先改核心文件，通过 Lint/编译后再处理次要文件。
- **自动搜索**：不确定的第三方 API 优先调用搜索工具，不凭空猜测。

## 5. 交互反馈

- 完成后列出 **已修改文件** 及 **核心变更点**，并提示可能需运行的命令（如 `go mod tidy`、`dart run build_runner build`）。
